import{a as l,t as p,d as Z}from"../chunks/disclose-version.CcNZgqTE.js";import{l as Ie,H as We,C as Je,aO as Le,aa as Ve,i as Ze,N as Ge,j as Ke,m as Xe,ah as Ye,p as le,c as i,s as d,b as s,t as P,g as e,a as ce,d as k,f as ee,x as $e,h as R,ab as F,o as me}from"../chunks/runtime.BDIqbqgT.js";import{d as je,s as I}from"../chunks/render.DOyiNjq8.js";import{a as E,p as z,i as j}from"../chunks/props.DGu_javW.js";import{e as oe,i as ne}from"../chunks/each.Cgaz3nQr.js";import{r as Qe,a as et,M as K,c as tt}from"../chunks/MaskedIcon.B5aeSKqF.js";import{s as G}from"../chunks/class.CRtDGy-0.js";import{b as at,t as ge,s as Ne,f as rt}from"../chunks/index.sLZEHBSK.js";import{m as st,b as it,s as ze,a as be}from"../chunks/store.DloAXBCC.js";import"../chunks/legacy.OXqrVy3J.js";import{w as Ae}from"../chunks/index.DcgXPdZy.js";import{r as ot}from"../chunks/shared.BuENEAWj.js";import{b as nt,a as lt}from"../chunks/input.s_nsuqxp.js";function ct(n,a,r){Ie&&We();var f=n,t=Ye,c,_=Je()?Le:Ve;Ze(()=>{_(t,t=a())&&(c&&Ge(c),c=Ke(()=>r(f)))}),Ie&&(f=Xe)}var vt=p('<div class="flex-1"></div>');function dt(n){var a=vt();l(n,a)}var U=(n=>(n.Text="Text",n.Select="Select",n.MultiSelect="MultiSelect",n))(U||{});const he=Ae(),ut=Ae([{id:4,title:"Description",possible_answers:[],answers:[],text:"Please describe the file in a few short sentences.",type:U.Text},{id:1,title:"Confidentiality",possible_answers:[{id:0,value:"Public"},{id:1,value:"Internal only"},{id:2,value:"Restricted"}],answers:[],text:"Please specify how you'd like this file to be considered in the system.",type:U.Select},{id:0,title:"Primary purpose",possible_answers:[{id:0,value:"Informational"},{id:1,value:"Instructional"},{id:2,value:"Analytical"},{id:3,value:"Educational"},{id:4,value:"Technical Reference"}],answers:[],text:"",type:U.MultiSelect},{id:2,title:"Topics",possible_answers:[{id:1,value:"Marketing"},{id:2,value:"Finance"},{id:3,value:"Technology"},{id:4,value:"Human Resources"},{id:5,value:"Education"},{id:6,value:"Design"}],answers:[],text:"What topics or categories does this file belong to?",type:U.MultiSelect}]);var pt=(n,a)=>a(n),ft=p('<label><input class="hidden" type="checkbox"> </label>');function _t(n,a){le(a,!0);let r=E(a,"group",31,()=>z([]));E(a,"class",3,"");let f=E(a,"multiple",3,!0);const t=()=>typeof a.value=="number"?+a.value:a.value;let c=k(()=>r().includes(t()));function _(D){const S=t();e(c)?r(r().filter(A=>A!==S)):r().includes(S)||(f()?r([...r(),S]):r([S]))}var u=ft(),h=i(u);Qe(h),h.__change=[pt,_];var o=d(h);s(u),P(()=>{G(u,`select-none cursor-pointer px-4 py-2 rounded border ${(e(c)?"text-accent bg-accent/5 border-accent":"border-gray-200 bg-gray-100 opacity-70 hover:opacity-100")??""} `),et(h,a.value),I(o,` ${a.label??""}`)}),l(n,u),ce()}je(["change"]);var gt=p('<textarea placeholder="Answer here..." class="p-5 min-h-[100px] resize-none w-full rounded border"></textarea>'),mt=p('<div><div class="text-lg font-semibold"> </div> <div> </div> <div class="mt-5 flex gap-5 items-center justify-center flex-wrap"><!></div></div>');function bt(n,a){le(a,!0);let r=E(a,"question",15),f=E(a,"proceed",15,!1),t=ee(z(r().answers)),c=ee(z(r().text_answer));$e(()=>{var w,x;r(r().answers=e(t),!0),r(r().text_answer=e(c),!0),f((((w=e(t))==null?void 0:w.length)??0)>0||(((x=e(c))==null?void 0:x.length)??0)>0)});var _=mt(),u=i(_),h=i(u,!0);s(u);var o=d(u,2),D=i(o,!0);s(o);var S=d(o,2),A=i(S);{var g=w=>{var x=gt();ot(x),nt(x,()=>e(c),v=>R(c,v)),l(w,x)},M=w=>{var x=Z(),v=F(x);oe(v,17,()=>r().possible_answers,ne,(T,N)=>{var C=k(()=>r().type===U.MultiSelect);_t(T,{get label(){return e(N).value},get value(){return e(N).id},get multiple(){return e(C)},get group(){return e(t)},set group(X){R(t,z(X))}})}),l(w,x)};j(A,w=>{r().type===U.Text?w(g):w(M,!1)})}s(S),s(_),P(()=>{I(h,r().title),I(D,r().text)}),l(n,_),ce()}var ht=p('<div class="flex items-center justify-center p-5"><label for="file-upload" class="flex items-center gap-3 border border-accent bg-accent/5 text-accent w-min whitespace-nowrap px-5 py-2 rounded hover:brightness-75 cursor-pointer"><!> Select files</label> <input id="file-upload" class="hidden" type="file" multiple></div>');function xt(n,a){let r=E(a,"files",15);var f=ht(),t=i(f),c=i(t);K(c,{src:"../paperclip.svg",class:"size-4 bg-accent"}),me(),s(t);var _=d(t,2);s(f),lt(_,r),l(n,f)}var yt=p('<li class="flex items-center gap-2"><!> </li>'),wt=p('<div class="font-light pb-2 text-accent">Selected files:</div> <ul class="px-3"></ul>',1),kt=p('<div class="text-center font-light opacity-80 italic">No files selected</div>'),St=p(`<div class="select-none"><p class="text-xl font-semibold">File Upload</p> <div class="py-2 opacity-60">Thank you for choosing to contribute in our research project. Please select files that you'd like to contribute to our system.</div> <div class="py-1 opacity-80">Help us improve our search by contributing. Contribution is a few-step process where you answer some questions about your files.</div> <div><div><!></div> <!></div></div>`);function qt(n,a){le(a,!0);const[r,f]=ze(),t=()=>be(he,"$filesStore",r);let c=E(a,"proceed",15);$e(()=>{var g;c((((g=t())==null?void 0:g.length)??0)>0)});var _=St(),u=d(i(_),6),h=i(u),o=i(h);xt(o,{get files(){return st(),t()},set files(g){it(he,z(g))}}),s(h);var D=d(h,2);{var S=g=>{var M=wt();const w=k(()=>Array.from(t()??[]).map(v=>v.name));var x=d(F(M),2);oe(x,21,()=>e(w),ne,(v,T)=>{var N=yt(),C=i(N);K(C,{src:"../checkmark-circle.svg",class:"size-3 bg-primary/50"});var X=d(C);s(N),P(()=>I(X,` ${e(T)??""}`)),l(v,N)}),s(x),l(g,M)},A=g=>{var M=kt();l(g,M)};j(D,g=>{var M;(((M=t())==null?void 0:M.length)??0)>0?g(S):g(A,!1)})}s(u),s(_),l(n,_),ce(),f()}var Mt=p('<div><div class="text-lg font-semibold">Submission</div> <div>Thank you for answering our questions. Please submit your responses below.</div> <div class="flex items-center justify-center"><button class="my-5 px-10 py-2 text-success bg-success/5 border border-success rounded hover:brightness-50">Submit</button></div> <pre> </pre></div>');function Tt(n,a){var r=Mt(),f=d(i(r),6),t=i(f);P(()=>I(t,`        ${JSON.stringify(Object.groupBy(a.questions,c=>c.file_id),null,1)??""}
    `)),s(f),s(r),l(n,r)}var It=p("<div><li><div><!> </div></li></div>"),Nt=p("<div><!> </div> <!>",1),$t=p('<div><div class="text-center"><div class="font-bold"> </div> <div><span class="text-accent"> </span> | <span class="opacity-30"> </span></div></div> <!></div>'),jt=(n,a)=>a(!1),zt=p('<button class="py-1 px-3 rounded bg-primary text-white opacity-70 hover:opacity-100">Back</button>'),At=(n,a)=>a(!0),Ct=p('<button class="py-1 px-3 rounded bg-primary text-white opacity-70 hover:opacity-100 disabled:bg-gray-400">Next</button>'),Ft=p('<span class="text-secondary font-nunito flex items-center gap-2"><!> Required</span>'),Pt=p('<div class="grid gap-5 grid-cols-[minmax(min-content,300px)_auto] h-full"><div class="select-none bg-dark-background border p-3 rounded-lg"><p class="text-xs opacity-40 uppercase pb-2"> </p> <ul class="p-5"><li><!> File Upload</li> <div class="font-nunito opacity-30 pt-2 text-xs uppercase">Files</div> <!> <li>Submission</li></ul></div> <div class="bg-dark-background border rounded-lg p-5 grid grid-rows-[auto_min-content]"><!> <div class="flex justify-between gap-5"><!> <!> <!></div></div></div>'),Dt=p('<p class="text-accent text-center">Contribution is not supported on mobile devices due to poor user experience.</p>');function Xt(n,a){le(a,!0);const[r,f]=ze(),t=()=>be(ut,"$questionsStore",r),c=()=>be(he,"$filesStore",r);let _=ee(0),u=ee(!1),h=k(()=>{var v;return 1+t().length*(((v=c())==null?void 0:v.length)??1)}),o=ee(0),D=k(()=>Array.from(c()??[]).flatMap(v=>t().map(T=>({file_id:v.name,...T})))),S=k(()=>e(D)[e(o)-1]);function A(v){c()&&(R(o,z(Math.min(Math.max(e(o)+(v?1:-1),0),1+t().length*c().length))),R(u,!1))}var g=Z(),M=F(g);{var w=v=>{var T=Pt(),N=i(T),C=i(N),X=i(C);s(C);var xe=d(C,2),te=i(xe),Ce=i(te),Fe=k(()=>`../${(e(o)>=0?"checkmark.svg":"circle.svg")??""}`);K(Ce,{get src(){return e(Fe)},class:"w-2 h-2 bg-secondary"}),me(),s(te);var ye=d(te,4);oe(ye,1,()=>Array.from(c()??[]),ne,(m,q,$)=>{var H=Nt();const O=k(()=>e(o)>=$*t().length+1&&e(o)<($+1)*t().length+1),b=k(()=>e(o)>=($+1)*t().length+1);var y=F(H),B=i(y),ve=k(()=>`../${(e(O)?"chevron-down.svg":e(b)?"checkmark.svg":"circle.svg")??""}`);K(B,{get src(){return e(ve)},class:"w-2.5 h-2.5 bg-secondary"});var W=d(B);s(y);var Y=d(y,2);oe(Y,1,t,ne,(de,re,J)=>{var se=Z();const L=k(()=>e(o)==1+J+$*t().length),ie=k(()=>e(o)>1+J+$*t().length);var ue=F(se);{var V=pe=>{var Q=It(),fe=i(Q),_e=i(fe),Te=i(_e),Oe=k(()=>`../${(e(ie)?"checkmark.svg":e(L)?"chevron-right.svg":"circle.svg")??""}`);K(Te,{get src(){return e(Oe)},class:"w-3 h-3 bg-secondary"});var Be=d(Te);s(_e),s(fe),s(Q),P(()=>{G(fe,`pl-5 ${(e(ie)||e(L)?"":"opacity-30")??""}`),G(_e,`flex gap-3 items-center ${(e(L)?"font-bold":"")??""}`),I(Be,` ${e(re).title??""}`)}),ge(1,Q,()=>Ne),ge(2,Q,()=>Ne),l(pe,Q)};j(ue,pe=>{e(O)&&pe(V)})}l(de,se)}),P(()=>{G(y,`pl-3 flex items-center gap-2 ${(e(b)?"italic text-secondary":"")??""}`),I(W,` ${e(q).name??""}`)}),l(m,H)});var Pe=d(ye,2);s(xe),s(N);var we=d(N,2),ke=i(we);{var De=m=>{qt(m,{get proceed(){return e(u)},set proceed(q){R(u,z(q))}})},Re=m=>{var q=Z(),$=F(q);{var H=b=>{Tt(b,{get questions(){return e(D)}})},O=b=>{var y=Z(),B=F(y);ct(B,()=>e(o),ve=>{var W=$t(),Y=i(W),ae=i(Y),de=i(ae,!0);s(ae);var re=d(ae,2),J=i(re),se=i(J,!0);s(J);var L=d(J,2),ie=i(L,!0);s(L),s(re),s(Y);var ue=d(Y,2);bt(ue,{get question(){return e(S)},get proceed(){return e(u)},set proceed(V){R(u,z(V))}}),s(W),P(()=>{var V;I(de,(V=e(S))==null?void 0:V.file_id),I(se,(e(o)-1)%t().length+1),I(ie,t().length)}),ge(1,W,()=>rt),l(ve,W)}),l(b,y)};j($,b=>{e(o)===e(h)?b(H):b(O,!1)},!0)}l(m,q)};j(ke,m=>{e(o)===0?m(De):m(Re,!1)})}var Se=d(ke,2),qe=i(Se);{var Ue=m=>{var q=zt();q.__click=[jt,A],l(m,q)};j(qe,m=>{e(o)>=1&&m(Ue)})}var Me=d(qe,2);dt(Me);var Ee=d(Me,2);{var He=m=>{var q=Z(),$=F(q);{var H=b=>{var y=Ct();y.__click=[At,A],l(b,y)},O=b=>{var y=Ft(),B=i(y);K(B,{src:"../chevron-right.svg",class:"size-3 bg-secondary animate-pulse"}),me(),s(y),l(b,y)};j($,b=>{e(u)?b(H):b(O,!1)})}l(m,q)};j(Ee,m=>{e(o)<e(h)&&m(He)})}s(Se),s(we),s(T),P(()=>{I(X,`Step ${e(o)+1} / ${e(h)+1}`),G(te,`flex items-center gap-3 ${(e(o)>=0?"font-bold":"")??""}`),G(Pe,tt(e(o)===e(h)?"font-bold":""))}),l(v,T)},x=v=>{var T=Dt();l(v,T)};j(M,v=>{e(_)>640?v(w):v(x,!1)})}at("innerWidth",v=>R(_,z(v))),l(n,g),ce(),f()}je(["click"]);export{Xt as component};
